# Query Performance Optimization (쿼리 성능 최적화 기본 원리)

## 1. 개념 정리
쿼리 성능 최적화(Query Performance Optimization)는
데이터베이스에서 SQL 쿼리를 더 빠르고 효율적으로 실행하기 위해
쿼리 작성 방식, 인덱스, 실행 계획 등을 개선하는 작업이다.

데이터베이스는 SQL을 그대로 실행하지 않고,
내부적으로 실행 계획(Execution Plan)을 수립한 후
가장 비용이 낮다고 판단되는 방식으로 쿼리를 수행한다.

즉,
- 쿼리 성능은 SQL 문법 자체보다
- 실행 계획과 인덱스 활용 여부에 의해 좌우된다.

---

## 2. 왜 중요한가
백엔드 서버의 응답 속도 저하는
대부분 비효율적인 쿼리에서 시작된다.

쿼리 성능을 고려하지 않으면:
- 테이블 풀 스캔 발생
- 불필요한 디스크 I/O 증가
- DB CPU 사용률 상승
- 전체 서비스 응답 지연

특히 트래픽이 증가할수록
비효율적인 쿼리는 장애로 직결될 가능성이 높아진다.

---

## 3. 백엔드 실무 관점
실무에서 쿼리 성능 최적화의 기본 원리는 다음과 같다.

- 인덱스를 활용할 수 있는 WHERE 조건 사용
- 조회 대상 컬럼 최소화 (SELECT *)
- 불필요한 조인 제거
- 조건절에서 함수 사용 최소화
- 실행 계획(EXPLAIN) 기반 분석

예를 들어:
- 인덱스 컬럼에 함수나 연산을 적용하면 인덱스를 타지 못한다
- 필요한 컬럼만 조회하면 디스크 I/O를 줄일 수 있다
- JOIN 순서와 조건에 따라 성능 차이가 크게 발생한다

Spring 기반 백엔드에서는
응답 지연 발생 시
비즈니스 로직보다 먼저 SQL 실행 계획을 점검하는 것이 일반적이다.

---

## 4. 트레이드오프 / 주의사항
- 성능 최적화를 위해 가독성이 떨어질 수 있다
- 인덱스를 늘리면 쓰기 성능이 저하된다
- 특정 쿼리에 최적화하면 다른 쿼리에 영향을 줄 수 있다

즉,
> 모든 쿼리를 극단적으로 최적화하기보다,
> 병목이 되는 쿼리를 중심으로 개선해야 한다.

라는 트레이드오프가 존재한다.

---

## 5. 예상 면접 질문 & 답변 연습

### Q1. 쿼리 성능이 느릴 때 가장 먼저 확인해야 할 것은 무엇인가요?
A.
SQL 실행 계획을 확인해
테이블 풀 스캔 여부와
인덱스 사용 여부를 점검합니다.

---

### Q2. SELECT * 은 왜 성능에 좋지 않나요?
A.
불필요한 컬럼까지 조회해
디스크 I/O와 메모리 사용량이 증가하기 때문입니다.

---

### Q3. 인덱스가 있는데도 느린 이유는 무엇일 수 있나요?
A.
조건절에 함수가 사용되거나,
인덱스 순서와 맞지 않는 조건을 사용해
인덱스를 제대로 활용하지 못했을 수 있습니다.

---

## 6. 한 문장 요약 (면접용)
쿼리 성능 최적화는
SQL 문법보다 실행 계획과 인덱스 활용을 중심으로 접근하며,
병목 쿼리를 선별해 개선하는 것이 핵심이다.
