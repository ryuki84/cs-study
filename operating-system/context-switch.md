# 컨텍스트 스위칭(Context Switching)

## 1. 개념 정리
컨텍스트 스위칭(Context Switching)이란  
CPU가 현재 실행 중인 작업(프로세스 또는 스레드)을 중단하고,  
다른 작업으로 전환하기 위해 **현재 작업의 상태(Context)를 저장하고  
새 작업의 상태를 복원하는 과정**을 의미한다.

여기서 컨텍스트(Context)란 다음과 같은 정보를 포함한다.
- 프로그램 카운터(PC)
- 레지스터 값
- 스택 포인터
- 프로세스/스레드 상태 정보

즉, 컨텍스트 스위칭은  
> “CPU가 다른 일을 하기 위해 기존 작업의 메모를 잠시 저장해 두는 과정”  
이라고 이해할 수 있다.

---

## 2. 왜 중요한가
컨텍스트 스위칭은 멀티태스킹을 가능하게 하지만,  
그 자체로 **비용이 발생하는 작업**이다.

컨텍스트 스위칭이 자주 발생하면:
- CPU 사용 효율이 떨어지고
- 캐시 미스(Cache Miss)가 증가하며
- 전체 시스템 성능이 저하될 수 있다

따라서 백엔드 서버에서는  
**“얼마나 많은 작업을 동시에 처리할 것인가”뿐만 아니라  
“불필요한 전환을 얼마나 줄일 것인가”**도 매우 중요하다.

---

## 3. 백엔드 실무 관점
Spring 기반 WAS는 일반적으로 다음과 같은 구조를 가진다.

- 요청 수만큼 스레드를 생성하지 않고
- **스레드 풀(Thread Pool)**을 사용해 재사용한다

이유는 다음과 같다.
- 스레드 생성/삭제 비용 절감
- 컨텍스트 스위칭 횟수 감소
- 시스템 안정성 향상

또한,
- 블로킹 I/O가 많은 경우
- 과도한 동기화로 스레드가 자주 대기 상태로 전환되는 경우

컨텍스트 스위칭이 급증해 **성능 저하나 장애**로 이어질 수 있다.

---

## 4. 트레이드오프 / 주의사항
- 스레드를 늘리면 동시성은 증가하지만 컨텍스트 스위칭 비용도 증가한다
- 스레드를 너무 적게 사용하면 요청 처리 지연이 발생할 수 있다

즉,
> **동시성(Thread 수) ↔ 컨텍스트 스위칭 비용**  
사이의 균형이 중요하다.

실무에서는:
- CPU 코어 수
- I/O 비중
- 서비스 특성

을 고려해 스레드 풀 크기를 조정한다.

---

## 5. 예상 면접 질문 & 답변 연습

### Q1. 컨텍스트 스위칭이란 무엇인가요?
A.  
CPU가 현재 실행 중인 프로세스나 스레드의 상태를 저장하고,  
다른 작업의 상태를 복원해 실행을 전환하는 과정입니다.  
멀티태스킹을 가능하게 하지만 성능 비용이 발생합니다.

---

### Q2. 컨텍스트 스위칭이 많아지면 왜 성능이 나빠지나요?
A.  
작업 전환 시 상태 저장과 복원 비용이 발생하고,  
CPU 캐시가 무효화되어 캐시 미스가 증가하기 때문입니다.  
결과적으로 실제 작업에 쓰이는 CPU 시간이 줄어듭니다.

---

### Q3. 백엔드 서버에서 컨텍스트 스위칭을 줄이기 위한 방법은?
A.  
스레드 풀을 사용해 스레드를 재사용하고,  
불필요한 동기화와 블로킹 작업을 줄이며,  
서비스 특성에 맞는 적절한 스레드 수를 유지하는 것이 중요합니다.

---

## 6. 한 문장 요약 (면접용)
컨텍스트 스위칭은 멀티태스킹의 핵심이지만 비용이 발생하므로,  
백엔드 서버에서는 **스레드 수와 동시성의 균형을 잡는 설계**가 중요합니다.
