# Transaction Propagation Practice
(Spring 트랜잭션 전파 실무 정리)

## 1. 개념 정리
트랜잭션 전파(Propagation)는
이미 트랜잭션이 존재할 때
새로운 트랜잭션 요청이 들어오면
이를 어떻게 처리할지에 대한 정책이다.

Spring에서는 @Transactional의 propagation 속성으로
전파 방식을 제어한다.

즉,
전파는
“트랜잭션을 합칠 것인가, 나눌 것인가”를 결정하는 규칙이다.

---

## 2. 왜 중요한가
전파 설정을 잘못 사용하면:
- 의도하지 않은 롤백
- 커밋 순서 꼬임
- 데이터 불일치
- 장애 복구 어려움

이 발생할 수 있다.

특히 하나의 요청에서
여러 서비스/모듈이 트랜잭션을 공유하는 경우,
전파 설정은 실무 안정성에 직접적인 영향을 준다.

---

## 3. 백엔드 실무 관점
실무에서 가장 많이 사용하는 전파 방식은 다음 두 가지다.

### REQUIRED (기본값)
- 기존 트랜잭션이 있으면 참여
- 없으면 새로 생성
- 하나의 트랜잭션으로 묶임

사용 예:
- 주문 생성 + 주문 상세 저장
- 동일 비즈니스 흐름

특징:
- 하나라도 실패하면 전체 롤백
- 정합성은 높지만 영향 범위 큼

---

### REQUIRES_NEW
- 항상 새로운 트랜잭션 생성
- 기존 트랜잭션은 일시 중단

사용 예:
- 로그 기록
- 이력 저장
- 알림/통계 적재

특징:
- 메인 트랜잭션 실패와 분리
- 커밋/롤백 독립
- 커넥션 추가 점유

---

## 4. 트레이드오프 / 주의사항
- REQUIRES_NEW 남용 시 커넥션 풀 고갈 위험
- REQUIRED는 장애 영향 범위가 큼
- 전파 설정은 트랜잭션 범위 설계와 함께 고려해야 함

즉,
> 전파는 기능 문제가 아니라
> 장애 전파 범위를 제어하는 도구다.

라는 관점이 중요하다.

---

## 5. 예상 면접 질문 & 답변 연습

### Q1. REQUIRED와 REQUIRES_NEW의 차이는 무엇인가요?
A.
REQUIRED는 기존 트랜잭션에 참여해 하나로 묶이고,
REQUIRES_NEW는 기존 트랜잭션과 분리된
독립 트랜잭션을 생성합니다.

---

### Q2. 로그 저장에 REQUIRES_NEW를 쓰는 이유는?
A.
메인 트랜잭션 실패와 상관없이
로그나 이력을 남기기 위해
트랜잭션을 분리합니다.

---

### Q3. REQUIRES_NEW 사용 시 주의할 점은?
A.
새로운 DB 커넥션을 점유하므로,
남용 시 커넥션 풀 고갈과 성능 저하를 유발할 수 있습니다.

---

## 6. 한 문장 요약 (면접용)
트랜잭션 전파는
트랜잭션을 합칠지 분리할지 결정해
장애 영향 범위를 제어하는 핵심 설계 요소다.
